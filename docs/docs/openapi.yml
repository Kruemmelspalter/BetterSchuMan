openapi: 3.0.0

info:
  version: 0.0.1
  title: Custom API for Schulmanager

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    teacher:
      type: object
      properties:
        id:
          type: integer
        firstname:
          type: string
          example: John
        lastname:
          type: string
          example: Doe
        abbreviation:
          type: string
          example: Do
    course:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
          example: Computer Science
        abbreviation:
          type: string
          example: CS
        teacher:
          $ref: "#/components/schemas/teacher"
        color:
          type: string

paths:
  /session:
    description: manage session (logging in and out etc.)
    get:
      security:
        - bearerAuth: [ ]
      description: get info about session
      responses:
        200:
          description: successfully fetched login info
          content:
            application/json:
              schema:
                type: object
                properties:
                  email:
                    type: string
                    example: john.doe@example.com
                  id:
                    type: integer
                  firstname:
                    type: string
                    example: John
                  lastname:
                    type: string
                    example: Doe
                  associatedStudent:
                    type: object
                    properties:
                      id:
                        type: integer
                      firstname:
                        type: string
                        example: John
                      lastname:
                        type: string
                        example: Doe

    post:
      description: Log in
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  required: true
                password:
                  type: string
                  required: true
      responses:
        201:
          description: Logging in was successful
          content:
            text/plain:
              schema:
                type: string
                description: Bearer JWT

  /schedule:
    get:
      security:
        - bearerAuth: [ ]
      parameters:
        - name: start
          schema:
            type: string
            example: 2021-11-08
          in: query
        - name: end
          schema:
            type: string
            example: 2021-11-14
          in: query
      responses:
        200:
          description: successfully fetched schedule
          content:
            application/json:
              schema:
                type: object
                properties:
                  hours:
                    type: array
                    items:
                      type: object
                      properties:
                        date:
                          type: string
                          example: 2021-11-10
                          description: date
                        hour:
                          type: number
                          description: hour id (see GET /schedule/hours)
                        room:
                          type: string
                          example: G053
                        cancelled:
                          type: boolean
                          example: false
                        substitue:
                          type: boolean
                          example: true
                        substituted:
                          type: object
                          description: the original lesson
                          properties:
                            room:
                              type: string
                              example: G036
                            subject:
                              type: object
                              properties:
                                abbreviation:
                                  type: string
                                  example: E
                                name:
                                  type: string
                                  example: English
                                label:
                                  type: string
                                  example: E9
                              teachers:
                                type: array
                                items:
                                  type: object
                                  properties:
                                    abbreviation:
                                      type: string
                                      example: D2
                                    firstname:
                                      type: string
                                      example: John2
                                    lastname:
                                      type: string
                                      example: Doe2
                        subject:
                          type: object
                          properties:
                            abbreviation:
                              type: string
                              example: CS
                            name:
                              type: string
                              example: Computer Science
                            label:
                              type: string
                              example: CS9

  /schedule/hours:
    get:
      security:
        - bearerAuth: [ ]
      responses:
        200:
          description: fetched hours
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: number
                      description: hour id
                    number:
                      type: string
                      description: number/display name
                    from:
                      type: string
                      description: time of the begin (format HH:mm:ss)
                    until:
                      type: string
                      description: time of the end (format HH:mm:ss)