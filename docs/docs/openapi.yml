openapi: 3.0.0

info:
  version: 0.0.1
  title: Custom API for Schulmanager

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    teacher:
      type: object
      properties:
        id:
          type: integer
        firstname:
          type: string
          example: John
        lastname:
          type: string
          example: Doe
        abbreviation:
          type: string
          example: Do
    course:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
          example: Computer Science
        abbreviation:
          type: string
          example: CS
        teacher:
          $ref: "#/components/schemas/teacher"
        color:
          type: string

paths:
  /session:
    description: manage session (logging in and out etc.)
    get:
      security:
        - bearerAuth: [ ]
      description: get info about session
      responses:
        200:
          description: successfully fetched login info
          content:
            application/json:
              schema:
                type: object
                properties:
                  email:
                    type: string
                    example: john.doe@example.com
                  id:
                    type: integer
                  firstname:
                    type: string
                    example: John
                  lastname:
                    type: string
                    example: Doe
                  associatedStudent:
                    type: object
                    properties:
                      id:
                        type: integer
                        firstname:
                          type: string
                          example: John
                        lastname:
                          type: string
                          example: Doe

        400:
          description: bad request
        401:
          description: bad credentials
        502:
          description: the Schulmanager servers returned something the server couldn't handle
        504:
          description: the Schulmanager servers didn't respond

    post:
      description: Log in
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  required: true
                password:
                  type: string
                  required: true
      responses:
        200:
          description: Logging in was successful
          headers:
            X-New-Bearer-Token:
              schema:
                type: string
              description: JWT Bearer Token
          content:
            text/plain:
              schema:
                type: string

        400:
          description: bad request
        401:
          description: bad credentials
        502:
          description: the Schulmanager servers returned something the server couldn't handle
        504:
          description: the Schulmanager servers didn't respond

  /schedule:
    get:
      security:
        - bearerAuth: [ ]
      parameters:
        - name: start
          schema:
            type: string
            example: 2021-11-08
          in: query
        - name: end
          schema:
            type: string
            example: 2021-11-14
          in: query
      responses:
        200:
          description: successfully fetched schedule
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    date:
                      type: string
                      example: 2021-11-10
                      description: date
                    from:
                      type: string
                      example: 12:10:00
                    to:
                      type: string
                      example: 12:55:00
                    room:
                      type: string
                      example: G053
                    cancelled:
                      type: boolean
                      example: false
                    substitue:
                      type: boolean
                      example: true
                    substituted:
                      type: object
                      description: the original lesson
                      properties:
                        room:
                          type: string
                          example: G036
                        subject:
                          type: object
                          properties:
                            abbreviation:
                              type: string
                              example: E
                            name:
                              type: string
                              example: English
                            label:
                              type: string
                              example: E9
                          teachers:
                            type: array
                            items:
                              type: object
                              properties:
                                abbreviation:
                                  type: string
                                  example: D2
                                firstname:
                                  type: string
                                  example: John2
                                lastname:
                                  type: string
                                  example: Doe2
                    subject:
                      type: object
                      properties:
                        abbreviation:
                          type: string
                          example: CS
                        name:
                          type: string
                          example: Computer Science
                        label:
                          type: string
                          example: CS9
        400:
          description: bad request
        401:
          description: logging in first is required
        502:
          description: the Schulmanager servers returned something the server couldn't handle
        504:
          description: the Schulmanager servers didn't respond
